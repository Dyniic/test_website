if RUBY_VERSION =~ /1.9/ # assuming you're running Ruby ~1.9
  Encoding.default_external = Encoding::UTF_8
  Encoding.default_internal = Encoding::UTF_8
end

require 'html-proofer'

# Action par dÃ©faut du rake
task :default => ["serve:website"]

# Nettoyage du repertoire _site.
desc "Nettoyage du _site"
task :clean do
  sh "jekyll clean"
end

# Build du site web.
namespace :build do
  desc "Build website"
  task :website => [:clean] do
    sh "LANG=en_US.UTF-8 jekyll build"
  end
end

# Lancement du serveur. 
namespace :serve do
  desc "Serve website"
  task :website => [:clean] do
    sh "jekyll serve"
  end
end

# Lancement des tests.
namespace :test do
  desc "Test Build"
  task :website => ["build:website"] do
    HTMLProofer.check_directory('./_site').run
  end
end
